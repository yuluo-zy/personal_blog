---
title: rust 备忘录
date: 2023-05-26T11:57:14+08:00
tags:
- rust
---

### 函数式

这里是关于`FnOnce`、`Fn`和`FnMut`之间的主要区别：

1. **调用次数和所有权**: 
   - `FnOnce`: 只能被调用一次，因为它获取了闭包或函数对象的所有权并在调用后消耗自身。这意味着它不能再被再次调用或移交所有权。适用于需要获取所有权并只执行一次的情况。
   - `Fn`: 可以被多次调用，并且可以被多个地方借用。它不能获取所有权，因此在调用后可以再次使用。适用于不需要修改闭包或函数对象所捕获环境的情况。
   - `FnMut`: 可以被多次调用，并且可以修改闭包或函数对象所捕获的环境。它可以被多个地方借用，并且每次调用都可以对环境进行修改。适用于需要在调用过程中修改闭包或函数对象所捕获环境的情况。

2. **捕获环境的可变性**:
   - `FnOnce` 和 `Fn`: 它们不能修改捕获的环境，因为它们是不可变的引用。如果闭包或函数对象需要对捕获的环境进行修改，则需要使用 `FnMut`。
   - `FnMut`: 允许对捕获的环境进行修改，因为它是可变的引用。如果闭包或函数对象需要修改其捕获环境的状态，则应使用 `FnMut`。

3. **函数对象的特点**:
   - `FnOnce`：适用于一次性的、不可变的闭包或函数对象。它们可以拥有闭包的所有权，并在调用后自动销毁。
   - `Fn`：适用于可以多次调用的、不需要修改闭包或函数对象所捕获环境的闭包或函数对象。
   - `FnMut`：适用于可以多次调用且需要修改闭包或函数对象所捕获环境的闭包或函数对象。

通过选择正确的 trait，可以确保闭包或函数对象在需要的情况下具有适当的调用方式和环境访问权限。这样可以使代码更加清晰和可靠，并确保代码的行为符合预期。